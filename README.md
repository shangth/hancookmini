# 寒厨记小程序

一款面向私人厨房聚会场景的微信小程序，旨在帮助用户高效管理聚会活动、菜品点选及食材准备。

## 项目说明

本项目为小程序端实现，使用 TypeScript + LESS 开发，当前使用 Mock 数据进行演示。

## 主要功能

### 1. 聚会列表页面 (`pages/gatherings`)
- ✅ 查看所有聚会
- ✅ 聚会状态展示（未开始/进行中/已结束）
- ✅ 菜单锁定状态显示
- ✅ 管理员功能：
  - 创建聚会
  - 编辑聚会
  - 删除聚会
  - 锁定/解锁菜单
  - 标记聚会为已结束
  - 进入备菜页面

### 2. 点菜页面 (`pages/ordering`)
- ✅ 菜品分类展示
- ✅ 菜品搜索（支持名称和原材料搜索）
- ✅ 个性化推荐菜品
- ✅ 点赞/取消点赞功能
- ✅ 实时显示点赞用户列表
- ✅ 查看点赞列表（全部/我的）
- ✅ 菜单锁定后禁止点赞
- ✅ 聚会结束后禁止点赞

### 3. 添加菜单页面 (`pages/add-dish`)
- ✅ 上传菜品图片
- ✅ 输入菜品名称
- ✅ 选择/新增菜品分类
- ✅ 选择菜品类型（多人份/一人份）
- ✅ 添加原材料列表
- ✅ 输入制作方法
- ✅ 添加备注信息
- ✅ 表单验证

### 4. 备菜页面 (`pages/preparation`)
- ✅ 阶段一：确定菜品
  - 查看所有被点赞的菜品
  - 按点赞数排序
  - 选择需要制作的菜品
  - 显示一人份菜品需要制作的份数
- ✅ 阶段二：生成清单
  - 显示已确定的菜品列表
  - 自动生成采购清单
  - 合并相同原材料
  - 标记采购状态
  - 显示采购进度
  - 支持重置采购状态

## 技术特点

### 数据管理
- 使用微信小程序本地存储 (wx.storage) 模拟后端数据
- 初始化时自动加载 Mock 数据
- 支持数据的增删改查操作

### 用户角色
- **管理员** (currentUser)：拥有所有权限
- **普通用户**：仅可查看和点赞

### Mock 数据
所有 Mock 数据定义在 `utils/mock-data.ts` 中：
- 4 个用户（1个管理员，3个普通用户）
- 3 个聚会（不同状态）
- 8 道菜品（不同分类和类型）
- 10 条点赞记录

### 工具函数
- `utils/types.ts`: TypeScript 类型定义
- `utils/storage.ts`: 本地存储管理
- `utils/date.ts`: 日期格式化工具
- `utils/mock-data.ts`: Mock 数据

## 项目结构

```
miniApp/
├── miniprogram/
│   ├── app.json          # 小程序配置
│   ├── app.ts            # 小程序入口
│   ├── app.less          # 全局样式
│   ├── components/       # 组件
│   │   └── navigation-bar/  # 自定义导航栏
│   ├── pages/           # 页面
│   │   ├── gatherings/  # 聚会列表
│   │   ├── ordering/    # 点菜页面
│   │   ├── add-dish/    # 添加菜单
│   │   └── preparation/ # 备菜页面
│   └── utils/           # 工具函数
│       ├── types.ts     # 类型定义
│       ├── mock-data.ts # Mock数据
│       ├── storage.ts   # 存储管理
│       └── date.ts      # 日期工具
└── package.json
```

## 开发说明

### 运行项目
1. 使用微信开发者工具打开 `miniApp` 目录
2. 项目会自动初始化 Mock 数据
3. 默认登录为管理员账号，可以使用所有功能

### 数据重置
如需重置数据，可在任意页面的控制台执行：
```javascript
require('./utils/storage').clearAllStorage()
require('./utils/storage').initStorage()
```

### 切换用户角色
在 `utils/mock-data.ts` 中修改 `currentUser` 的值：
```typescript
export const currentUser = mockUsers[0] // 管理员
// export const currentUser = mockUsers[1] // 普通用户
```

## 功能演示流程

### 1. 管理员创建聚会
1. 进入聚会列表页面
2. 点击右下角 "+" 按钮
3. 填写聚会信息（名称、时间、地点）
4. 确认创建

### 2. 添加菜品
1. 点击页面底部的菜单按钮（🍳）
2. 上传菜品图片
3. 填写菜品信息
4. 添加原材料
5. 确认添加

### 3. 用户点菜
1. 点击聚会卡片进入点菜页面
2. 浏览推荐菜品和分类菜品
3. 点击心形图标进行点赞
4. 点击右下角订单按钮查看点赞列表

### 4. 管理员备菜
1. 在聚会列表中点击聚会的操作按钮
2. 选择"备菜"
3. 在确定菜品阶段选择要制作的菜品
4. 生成采购清单
5. 在采购清单中勾选已采购的原材料

## 注意事项

1. **图片上传**：当前仅选择本地图片，实际项目需要上传到服务器
2. **数据持久化**：使用本地存储，清除缓存会丢失数据
3. **WebSocket**：当前使用本地状态模拟实时同步，实际需要接入 WebSocket 服务
4. **用户登录**：当前使用固定用户，实际需要接入微信登录

## 待完善功能

- [ ] 接入真实后端接口
- [ ] 实现 WebSocket 实时通信
- [ ] 图片上传到服务器
- [ ] 微信登录授权
- [ ] 用户搜索历史功能
- [ ] 菜品详情页面
- [ ] 更多推荐算法优化
- [ ] 数据统计和分析

## 开发规范

- 使用 TypeScript 进行类型约束
- 使用 LESS 编写样式
- 组件化开发
- 代码注释清晰
- 遵循小程序开发规范

## 版本信息

- 版本：v1.0.0
- 开发日期：2025-10-14
- 技术栈：微信小程序 + TypeScript + LESS


