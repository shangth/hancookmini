<view class="container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <navigation-bar title="èšä¼šåˆ—è¡¨" />
  
  <!-- èšä¼šåˆ—è¡¨ -->
  <view class="gatherings-list">
    <view wx:for="{{gatherings}}" wx:key="id" class="gathering-card" bindtap="goToOrdering" data-id="{{item.id}}">
      <!-- å¡ç‰‡å¤´éƒ¨ -->
      <view class="card-header">
        <view class="gathering-name">{{item.name}}</view>
        <view class="gathering-status">
          <view class="tag {{getStatusClass(item.status)}}">{{getStatusText(item.status)}}</view>
          <view class="tag {{item.menu_locked ? 'tag-danger' : 'tag-success'}}" style="margin-left: 10rpx;">
            {{item.menu_locked ? 'å·²é”å®š' : 'æœªé”å®š'}}
          </view>
        </view>
      </view>
      
      <!-- èšä¼šä¿¡æ¯ -->
      <view class="gathering-info">
        <view class="info-item">
          <text class="icon">ğŸ“…</text>
          <text class="info-text">{{formatDate(item.time)}}</text>
        </view>
        <view class="info-item">
          <text class="icon">ğŸ“</text>
          <text class="info-text">{{item.location}}</text>
        </view>
      </view>
      
      <!-- ç®¡ç†å‘˜æ“ä½œæŒ‰é’® -->
      <view wx:if="{{isAdmin}}" class="card-actions" catchtap="stopPropagation">
        <view class="action-btn" catchtap="showActionSheet" data-id="{{item.id}}">
          <text class="action-icon">â‹¯</text>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{gatherings.length === 0}}" class="empty-state">
      <view class="empty-state-icon">ğŸ½ï¸</view>
      <view class="empty-state-text">æš‚æ— èšä¼š</view>
    </view>
  </view>
  
  <!-- ç®¡ç†å‘˜åˆ›å»ºæŒ‰é’® -->
  <view wx:if="{{isAdmin}}" class="fab" bindtap="showCreateDialog">
    <text style="color: #fff; font-size: 48rpx;">+</text>
  </view>
  
  <!-- æ·»åŠ èœå•æŒ‰é’® -->
  <view wx:if="{{isAdmin}}" class="fab-menu" bindtap="goToAddDish">
    <text style="color: #fff; font-size: 32rpx;">ğŸ³</text>
  </view>
  
  <!-- åˆ›å»º/ç¼–è¾‘èšä¼šå¼¹çª— -->
  <view wx:if="{{showDialog}}" class="modal-overlay" bindtap="hideDialog">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <view class="modal-title">{{dialogMode === 'create' ? 'åˆ›å»ºèšä¼š' : 'ç¼–è¾‘èšä¼š'}}</view>
        <view class="modal-close" bindtap="hideDialog">âœ•</view>
      </view>
      
      <view class="modal-body">
        <view class="form-group">
          <view class="form-label">èšä¼šåç§°</view>
          <input class="form-input" placeholder="è¯·è¾“å…¥èšä¼šåç§°" value="{{formData.name}}" bindinput="onInputName" maxlength="50" />
        </view>
        
        <view class="form-group">
          <view class="form-label">èšä¼šæ—¶é—´</view>
          <picker mode="date" value="{{formData.date}}" bindchange="onDateChange">
            <view class="form-input picker-input">{{formData.date || 'è¯·é€‰æ‹©æ—¥æœŸ'}}</view>
          </picker>
          <picker mode="time" value="{{formData.time}}" bindchange="onTimeChange">
            <view class="form-input picker-input" style="margin-top: 10rpx;">{{formData.time || 'è¯·é€‰æ‹©æ—¶é—´'}}</view>
          </picker>
        </view>
        
        <view class="form-group">
          <view class="form-label">èšä¼šåœ°ç‚¹</view>
          <input class="form-input" placeholder="è¯·è¾“å…¥èšä¼šåœ°ç‚¹" value="{{formData.location}}" bindinput="onInputLocation" maxlength="100" />
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="btn-secondary" bindtap="hideDialog">å–æ¶ˆ</button>
        <button class="btn-primary" bindtap="submitForm">ç¡®è®¤</button>
      </view>
    </view>
  </view>
</view>


