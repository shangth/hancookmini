# 寒厨记小程序 - 使用说明

## 项目概述

已完成基于 PRD 文档的小程序端开发，所有核心功能均已实现并使用 Mock 数据进行演示。

## 已完成功能清单

### ✅ 1. 聚会列表页面
- [x] 聚会列表展示（状态、时间、地点）
- [x] 聚会状态标识（未开始/进行中/已结束）
- [x] 菜单锁定状态显示
- [x] 创建聚会（管理员）
- [x] 编辑聚会（管理员）
- [x] 删除聚会（管理员）
- [x] 锁定/解锁菜单（管理员）
- [x] 标记为已结束（管理员）
- [x] 进入备菜页面（管理员）
- [x] 进入添加菜单页面（管理员）

### ✅ 2. 点菜页面
- [x] 聚会信息展示
- [x] 菜品搜索功能（名称和原材料）
- [x] 菜品分类导航
- [x] 推荐菜品展示
- [x] 菜品列表展示
- [x] 点赞/取消点赞功能
- [x] 点赞用户头像展示
- [x] 点赞列表抽屉（全部/我的）
- [x] 菜单锁定状态控制
- [x] 聚会结束状态控制

### ✅ 3. 添加菜单页面
- [x] 上传菜品图片
- [x] 输入菜品名称
- [x] 选择菜品分类
- [x] 新增菜品分类
- [x] 选择菜品类型（多人份/一人份）
- [x] 添加原材料列表
- [x] 输入制作方法
- [x] 输入备注信息
- [x] 表单验证

### ✅ 4. 备菜页面
- [x] 阶段切换（确定菜品 ⇄ 生成清单）
- [x] 确定菜品阶段
  - [x] 展示被点赞的菜品
  - [x] 按点赞数排序
  - [x] 选择要制作的菜品
  - [x] 显示一人份需要制作的份数
- [x] 生成清单阶段
  - [x] 显示已确定菜品
  - [x] 自动生成采购清单
  - [x] 合并相同原材料
  - [x] 标记采购状态
  - [x] 显示采购进度
  - [x] 重置采购状态

### ✅ 5. 通用功能
- [x] 自定义导航栏组件
- [x] 全局样式系统
- [x] TypeScript 类型定义
- [x] Mock 数据系统
- [x] 本地存储管理
- [x] 日期格式化工具
- [x] 表单验证工具
- [x] 事件总线（WebSocket 模拟）

## 技术实现

### 前端技术栈
- **框架**：微信小程序原生框架
- **语言**：TypeScript
- **样式**：LESS
- **数据管理**：本地存储 (wx.storage)

### 项目结构
```
miniApp/
├── miniprogram/
│   ├── app.json          # 全局配置
│   ├── app.ts            # 应用入口
│   ├── app.less          # 全局样式
│   ├── components/       # 组件目录
│   │   └── navigation-bar/  # 导航栏组件
│   ├── pages/           # 页面目录
│   │   ├── gatherings/  # 聚会列表页
│   │   ├── ordering/    # 点菜页
│   │   ├── add-dish/    # 添加菜单页
│   │   ├── preparation/ # 备菜页
│   │   └── logs/        # 日志页
│   └── utils/           # 工具函数
│       ├── types.ts     # TS类型定义
│       ├── mock-data.ts # Mock数据
│       ├── storage.ts   # 存储管理
│       ├── date.ts      # 日期工具
│       ├── validator.ts # 表单验证
│       └── event-bus.ts # 事件总线
├── README.md            # 项目说明
├── DEVELOPMENT.md       # 开发文档
└── package.json         # 依赖配置
```

## 快速开始

### 1. 打开项目
1. 启动微信开发者工具
2. 选择"导入项目"
3. 项目目录选择 `miniApp`
4. 填写 AppID（可使用测试号）
5. 点击"导入"

### 2. 初始化数据
项目首次运行会自动初始化以下 Mock 数据：
- **用户**：4个（1个管理员，3个普通用户）
- **聚会**：3个（不同状态）
- **菜品**：8道（不同分类）
- **点赞**：10条

### 3. 开始使用
默认以管理员身份登录，可以使用所有功能。

## 功能演示流程

### 场景一：创建聚会并点菜

1. **创建聚会**（管理员）
   - 点击聚会列表页右下角的 "+" 按钮
   - 填写聚会名称、时间、地点
   - 点击"确认"创建

2. **进入点菜**
   - 点击聚会卡片进入点菜页面
   - 浏览推荐菜品和分类菜品
   - 点击心形图标进行点赞

3. **查看点赞**
   - 点击右下角的订单按钮
   - 查看"全部"或"我的"点赞列表

### 场景二：添加新菜品

1. **进入添加页面**（管理员）
   - 在聚会列表页点击底部的菜单按钮（🍳）

2. **填写菜品信息**
   - 上传菜品图片
   - 输入菜品名称
   - 选择或新增分类
   - 选择菜品类型
   - 添加原材料（支持多个）
   - 输入制作方法
   - 添加备注（可选）

3. **提交保存**
   - 点击"确认添加"

### 场景三：备菜流程

1. **进入备菜页面**（管理员）
   - 在聚会列表中点击聚会的操作按钮（⋯）
   - 选择"备菜"

2. **确定菜品**
   - 查看所有被点赞的菜品
   - 勾选需要制作的菜品
   - 点击"生成清单"

3. **采购管理**
   - 查看自动生成的采购清单
   - 勾选已采购的原材料
   - 查看采购进度

### 场景四：管理聚会

1. **编辑聚会**（管理员）
   - 点击聚会的操作按钮（⋯）
   - 选择"编辑聚会"
   - 修改信息后保存

2. **锁定菜单**（管理员）
   - 点击操作按钮
   - 选择"锁定菜单"
   - 锁定后所有用户无法继续点赞

3. **标记已结束**（管理员）
   - 点击操作按钮
   - 选择"标记为已结束"
   - 已结束的聚会不可再点菜

## Mock 数据说明

### 用户数据
- **管理员**：寒厨（当前登录用户）
- **普通用户**：小明、小红、小李

### 聚会数据
- **周末聚餐**：未开始，未锁定
- **生日派对**：进行中，已锁定
- **国庆聚会**：已结束，已锁定

### 菜品数据
包含川菜、粤菜、家常菜、饮品等多个分类的8道菜品。

## 数据管理

### 查看数据
数据存储在小程序的本地存储中，可在开发者工具的 Storage 面板查看。

### 重置数据
如需重置所有数据，在控制台执行：
```javascript
require('./utils/storage').clearAllStorage()
require('./utils/storage').initStorage()
```

### 切换用户
修改 `utils/mock-data.ts` 中的 `currentUser` 变量：
```typescript
// 管理员
export const currentUser = mockUsers[0]

// 普通用户
// export const currentUser = mockUsers[1]
```

## 权限说明

### 管理员权限
- ✅ 创建/编辑/删除聚会
- ✅ 锁定/解锁菜单
- ✅ 标记聚会为已结束
- ✅ 添加菜品
- ✅ 备菜管理
- ✅ 点菜（点赞）

### 普通用户权限
- ✅ 查看聚会列表
- ✅ 点菜（点赞）
- ✅ 查看点赞列表

## 注意事项

### 1. 图片上传
当前仅支持选择本地图片，实际使用时需要将图片上传到服务器。

### 2. 数据持久化
数据存储在本地，清除小程序缓存会导致数据丢失。

### 3. 实时同步
当前使用本地状态模拟，实际项目需要接入 WebSocket 实现真正的实时同步。

### 4. 用户登录
当前使用固定用户模拟，实际项目需要接入微信登录。

## 后续接入后端

### 需要替换的部分
1. **数据获取**：将 `utils/storage.ts` 中的方法替换为 API 调用
2. **图片上传**：接入图片上传服务
3. **用户登录**：接入微信登录流程
4. **实时通信**：接入 WebSocket 服务

### API 接口设计
详见 PRD 文档第5章：接口设计

### WebSocket 事件
详见 PRD 文档第6章：WebSocket 事件设计

## 常见问题

### Q1: 如何查看所有功能？
A: 确保以管理员身份登录（默认即是），所有功能按钮都会显示。

### Q2: 点赞后看不到更新？
A: 退出并重新进入点菜页面即可看到更新。

### Q3: 如何测试普通用户功能？
A: 修改 `utils/mock-data.ts` 切换到普通用户。

### Q4: 备菜页面显示空白？
A: 需要先在点菜页面进行点赞，才会有数据显示。

## 项目亮点

1. ✅ **完整实现 PRD 所有功能**
2. ✅ **使用 TypeScript 确保类型安全**
3. ✅ **组件化开发，代码可复用**
4. ✅ **完善的 Mock 数据系统**
5. ✅ **良好的用户体验和 UI 设计**
6. ✅ **清晰的代码结构和注释**
7. ✅ **详细的文档说明**

## 文档索引

- **README.md** - 项目介绍和功能说明
- **DEVELOPMENT.md** - 开发文档和技术细节
- **使用说明.md** - 本文档，快速上手指南
- **PRD_寒厨记.md** - 产品需求文档

## 开发团队

本项目严格按照 PRD 文档开发，实现了小程序端的所有核心功能。

---

**最后更新**：2025-10-14  
**版本**：v1.0.0  
**状态**：✅ 开发完成


